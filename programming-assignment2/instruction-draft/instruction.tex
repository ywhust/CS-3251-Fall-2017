%%
%% Author: Long Gong
%% 11/10/2017
%%

% Preamble
\documentclass[12pt]{article}
\usepackage{fullpage}

\usepackage{xcolor}
\usepackage[colorlinks,
linkcolor={red!50!black},
citecolor={blue!50!black},
urlcolor={blue!80!black}]{hyperref}
\usepackage{footnotebackref} % add backward link from footnote

\usepackage{ifthen}
\usepackage{etoolbox}
\usepackage{url}
%% packages for multirow
\usepackage{multirow}
\usepackage{minted}

%% for tables
\usepackage{booktabs}
%% use "autoref" the way I want
%   autoref is nice because the text or brackets of a ref are part of link
%   see http://tex.stackexchange.com/questions/36575/autorefs-inserted-text-has-not-the-correct-case
%       http://en.wikibooks.org/wiki/LaTeX/Labels_and_Cross-referencing
%       http://www.tug.org/applications/hyperref/manual.html#TBL-23

%% define autoref name for sections
% \ifx\sectionautorefname\defined
\def\sectionautorefname{$\S\!\!$}
\def\subsectionautorefname{$\S\!\!$}
\def\subsubsectionautorefname{$\S\!\!$}
% \fi
% from http://tex.stackexchange.com/questions/52410/how-to-use-the-command-autoref-to-implement-the-same-effect-when-use-the-comman
% \ifx\equationautorefname~#1\undefined
\def\equationautorefname~#1\null{%
(#1)\null
}
% \fi%
\newcommand*{\subfigureautorefname}{Figure}


% Document
\begin{document}

\title{CS 3251 Project 2: Hangman Game}
\date{}

\maketitle

\section{Overview}\label{sec:overview}

The aim of this project is to have you write a game-server and a player-client for a simple
hangman game.
You have to develop a game-server and a client (player) that establishes connection with the
game-server and plays a game of hangman.
The client will be much more simple than the
server.
{\bf This project is much more complicated than the first so do not wait until the last minute.}

\section{Details}\label{sec:details}

First, a (perhaps obvious) note on command syntax for this instruction:

\begin{itemize}
\item ``\$'' precedes Linux commands that should be typed or the output you print out to the stdout.
\end{itemize}


\subsection{Server -- Hangman Game Server }\label{subsec:server--HangmanGameServer}

\begin{itemize}
\item The server should be able to manage {\bf 3} clients (players) at any given time.
\item Each client will be playing their own separate game\footnote{Note that, you are required to implement a multi-player version for extra credit (see more details in~\autoref{subsec:extraCredit}).}.
\item The server should handle all administrative duties of each client's game such as
choosing the word and keeping track of the score.
\item The server will tell the client if the guess is correct or not and keep track of the number of
guesses the client has made.
\item Loop listening for connections:
     \begin{itemize}
       \item When server starts, a connection handler starts listening for incoming game
       request connections from the client.
       \item Server keeps listening during and after play.
     \end{itemize}
\item On successful connection with a client the game-server should choose a game word and
wait for the packet sent from the client signaling the game should start.
\item It should then respond using a game control packet (seen below), the client will add the
formatting and display the following to the player:
\begin{itemize}
\item For the game word ``hangman''
\begin{minted}[
baselinestretch=1.2,
fontsize=\footnotesize
]{bash}
$ _ _ _ _ _ _ _
$ Incorrect Guesses:
\end{minted}
\end{itemize}
\item After a client guesses a letter the server replies back with the updated word, filling in
correct letters and supplying incorrect guesses.
\begin{itemize}
\item For example, client has guessed ``n'' (correct guess).
Server responds with:
\begin{minted}[
baselinestretch=1.2,
fontsize=\footnotesize
]{bash}
$ _ _ n _ _ _ n
$ Incorrect Guesses:
\end{minted}

\item Client then guesses ``p'' (incorrect).
Server responds with:

\begin{minted}[
baselinestretch=1.2,
fontsize=\footnotesize
]{bash}
$ _ _ n _ _ _ n
$ Incorrect Guesses: P
\end{minted}

\end{itemize}
\item When the game is over tell the client if they won or lost then terminate connection.
\begin{itemize}
\item Game ends when client guesses {\bf 6} incorrect letters or if all correct letters for the
word have been guessed.
\end{itemize}
\item The server should choose a word at random for each game.
Please choose {\bf 15} total
possible words for your server to choose from.
\begin{itemize}
\item The words must range in size from {\bf a minimum length of 3 letters to a max length
of 8}.
\item You must choose words of {\bf at least three different lengths}.
For example, five 4-letter words, five 5-letter words, and five 8-letter words
\item Each word must have an equal chance of being chosen by your server for a new
game.
\end{itemize}
\item If a fourth client (player) tries to connect to the game-server, the server should send
``server-overloaded'' message (please follow the server message format in~\autoref{subsec:serverMessageHeader}) then gracefully end connection.
\item After ending a game with a client the server should be able to accept a new connection
from a clients until limit(3) is reached again and so on.
\end{itemize}

\subsection{Client -- Player}\label{subsec:client--Player}
\begin{itemize}
\item Use server IP and Port to connect to a game server.
\item Once connected ask user if they are ready to start the game as follows:
\begin{minted}[
baselinestretch=1.2,
fontsize=\footnotesize
]{bash}
$ Ready to start game? (y/n): 
\end{minted}
\begin{itemize}
\item If the user says no terminate client otherwise send an empty message to the
server with msg length = 0. (more on this below) signaling game start.
\end{itemize}
\item The server will then respond with it’s first game control packet which the client should
properly print out.
\item The client will then ask the player for a guess exactly as follows:
\begin{minted}[
baselinestretch=1.2,
fontsize=\footnotesize
]{bash}
$ Letter to guess:  
\end{minted}
\item Client then sends guess to the server.
{\bf Make sure that the user guess is formatted correctly.}
\begin{itemize}
\item If the user guesses something invalid like a number or more than one letter
please respond with an error then ask for input again as follows:
\begin{minted}[
baselinestretch=1.2,
fontsize=\footnotesize
]{bash}
$ Letter to guess: 5
$ Error! Please guess one letter.
$ Letter to guess: aa
$ Error! Please guess one letter.
$ Letter to guess:
\end{minted}
\item If the user guesses something that has been guessed before ({\it i.e.,} some duplicate letter), please respond with an error then ask for input again as follows:
\begin{minted}[
baselinestretch=1.2,
fontsize=\footnotesize
]{bash}
$ Letter to guess: a                # a has been guessed before
$ Error! Letter A has been guessed before, please guess another letter.
$ Letter to guess:
\end{minted}
\end{itemize}
\item Player keeps guessing letters while the server responds with updated game information.
\item Continue until game word is either correctly guessed or guess limit is exceeded.
\item Client should terminate when game is over.
\item Client should be able to accept lower or uppercase letters as a guess but must make
sure to convert to lowercase before sending to the server.
\end{itemize}

\subsection{Server Message Header}\label{subsec:serverMessageHeader}

When sending messages to a client the server must use the following format. {\bf Up to 2-point penalty, if failing to strictly follow this format.}

\begin{center}\begin{tabular}{|p{3cm}|p{3cm}|p{3cm}|p{3cm}|}
\hline
Msg flag & Word length & Num Incorrect & Data\\\hline
\end{tabular}\end{center}

\noindent
{\bf Msg flag} (1 byte) is used when the server would like to send a string message to a client. If the
server is sending a message to the client the Msg flag will be set to the length of the message
otherwise Msg flag will be zero. If the message flag is set then there are no Word length or Num
Incorrect fields the entire packet minus the message flag is message data. When a client
receives a message from the server it should directly print it out. The client should print
messages out in the order they are received.
\medskip
\begin{center}
\begin{tabular}{c}
- An example of a message could be ``Game Over!'', ``You Win!'', ``You Lose :(''
\end{tabular}
\end{center}
\medskip
If the message flag is zero then we have a normal game control packet.

\noindent
{\bf Word length} (1 byte) is the length of the word the user is trying to guess.The first n bytes in the
data segment of the packet where n is the value of Word Length will be used to store the
positions of the letters that have been guessed correctly so far.

\noindent
{\bf Num Incorrect} (1 byte) is the number of incorrect guesses a client has made. The incorrect
guessed letters will be after the game word in the data segment.


Two example data packets can be see below. In the example each box is one byte.
This packet would be a game control packet with the game word being ``green'' and the user
having guessed g, and e correctly. The user has guessed a, b, and c incorrectly.

\begin{center}
\setlength{\columnsep}{2pt}
\begin{tabular}{|p{1.5cm}|p{2.4cm}|p{3cm}|*{8}{p{0.5cm}|}}
\hline
Msg flag & Word length & Num incorrect &\multicolumn{8}{c|}{Data} \\\hline
\multicolumn{1}{|c|}{0} & \multicolumn{1}{c|}{5} & \multicolumn{1}{c|}{3} & ``g'' & ``\_'' & ``e'' & ``e'' & ``\_'' & ``a'' & ``b'' & ``c'' \\\hline
\end{tabular}
\end{center}
\medskip
This packet is an example of a message packet. When the client receives a message packet it
should directly print out the contents.

\begin{center}
\setlength{\columnsep}{2pt}
\begin{tabular}{|p{1.5cm}|*{8}{p{1.2cm}|}}
\hline
Msg flag  & \multicolumn{8}{c|}{Data} \\\hline
\multicolumn{1}{|c|}{8} & ``Y'' & ``o'' & ``u'' &  `` '' & ``W'' & ``i'' & ``n'' & ``!''  \\\hline
\end{tabular}
\end{center}


\subsection{Client Message Header }\label{subsec:clientMessageHeader}

This defines the message the client will send to the server. {\bf Up to 1-point penalty, if failing to strictly follow this format.}

\begin{center}
\begin{tabular}{|*{2}{p{5cm}|}}
\hline
Msg Length & Data\\ \hline
\end{tabular}
\end{center}

An example packet could be the following when a client is guessing “a”.

\begin{center}
\begin{tabular}{|*{2}{p{5cm}|}}
\hline
Msg Length & Data\\ \hline
1 & ``a''\\\hline
\end{tabular}
\end{center}


\subsection{Example Program flow}\label{subsec:exampleProgramFlow}

The following is an example game output from a client connecting to a game server at the
address 0.0.0.0 and on port 8080. The server chose the game word ``dog''.

\usemintedstyle{vs}
% \setminted{fontsize=\footnotesize,baselinestretch=1}
\begin{minted}[
baselinestretch=1.2,
fontsize=\footnotesize
]{bash}
$ ./client 0.0.0.0 8080          # connect to server
$ Ready to start game? (y/n): y  # Client asks if player is ready to start and sends empty
                                 # message (0) to server signaling game start
$ _ _ _                          # Server responds with first game control packet
$ Incorrect Guesses:
$                                # Print new line after Incorrect Guesses for readability
$ Letter to guess: a             # Client asks for input and user types “a”
$ _ _ _                          # Server responds
$ Incorrect Guesses: a
$
$ Letter to guess: d             # Client asks for input and user types “d”
$ d _ _                          # Server responds
$ Incorrect Guesses: a
$ Letter to guess: g             # Client asks for input and user types “g”
$ d _ g                          # Server responds
$ Incorrect Guesses: a
$
$ Letter to guess: o             # Client asks for input and user types “o”
$ d o g                          # Server responds
$ Incorrect Guesses: a
$ You Win!
$ Game Over!
\end{minted}
\medskip
If the player instead guesses 6 incorrect letters and loses the game replace “You Win!” with 
``You Lose :(''.

\subsection{Extra Credit}\label{subsec:extraCredit}

You may implement a multi-player version of the hangman game for some extra credit 
points\footnote{Note that, this part is slightly different from Section B.}. 
Unlike the normal part, we decide to give you some freedom to design the interactions 
between server and client in this extra-credit part. You can design the interactions in whatever 
way you like {\bf as long as the interactions (communications) between the server and 
client strictly follow the message format described in~\autoref{subsec:serverMessageHeader} 
and \autoref{subsec:clientMessageHeader} respectively.} And please explain the reason behind your design. \autoref{subsubsec: possibleDesign} gives you an example.

\subsubsection{A Possible Design}\label{subsubsec: possibleDesign}
\begin{itemize}
\item When the client first starts instead of asking if the player is ready to start the game ask if 
the the game will be $2$ player. 
\begin{minted}[
baselinestretch=1.2,
fontsize=\footnotesize
]{bash}
$ Two Player? (y/n):
\end{minted}
\item If the player responds no continue as normal by sending server ``0''.
\item If the player says yes send server ``2''.
\item The server will then respond to the client right away with a message packet saying 
``Waiting for other player!''
\begin{itemize}
\item The first client to request a 2 player game will be player 1.
\end{itemize}
\item The server will wait for another client to request a two player game. 
\begin{itemize}
\item This player will be player 2 
\end{itemize}
\item When the server receives a second request it will initialize a game as normal and will 
send a message to both players containing ``Game Starting!''
\item The server will then send a message to player 1 saying ``Your Turn!'' followed by a 
normal game control packet and the client will ask for a letter. 
\item Once player 1 guesses the server will respond with a string message containing either 
``Incorrect!'' or ``Correct!'' depending on if the letter guessed was correct. An example of 
what player 1 would see follows. Let’s say the game word is ``green''. 
\begin{minted}[
baselinestretch=1.2,
fontsize=\footnotesize
]{bash}
$ Game Starting! 
$ Your Turn! 
$ _ _ _ _ _ 
$ Incorrect Guesses: 
$  
$ Letter to guess: e 
$ Correct! 
$ Waiting on Player 2... 
\end{minted}
\item Player 2 is then up. Player 2 would have seen the following. 
\begin{minted}[
baselinestretch=1.2,
fontsize=\footnotesize
]{bash}
$ Game Starting! 
$ Waiting on Player 1... 
$ Your Turn! 
$ _ _ e e _ 
$ Incorrect Guesses: 
$  
$ Letter to guess: 
\end{minted}

\item The game then follows this pattern until the two players reach 6 incorrect guesses or 
they correctly guess the word. The game will then end similar to a single player game. 

\end{itemize}

\subsection{Logistics}

\begin{itemize}
    \item Students can work in groups of 2 max for this project 
    \item Languages - \textsc{C, Python, Java}
\end{itemize}
\end{document}